# html 优化

1. 减少文件大小，包括删除空白符合注释，变量替换为短字符串，`gzip` 压缩，内联文件提取到外链文件。
1. 文件合并，减少请求数。`HTTP` 同时进行的请求数量有限，`HTTP` 连接耗时，减少请求缓存次数。
比如合成雪碧图。
1. `CDN`
1. 减少域名查找时间，文件放在同一域名下。
1. 使用 `HTTP` 缓存。
1. 指定图片的尺寸，表格 `table-layout: fixed`，减少重排和重绘。
1. `img` 懒加载 `loading="lazy"`
1. `<script>` 放到最后，或使用异步属性

## `<script>` 放到最后的原因

当遇到 `<script>` 时，浏览器会下载并解析执行 `js` 文件，这会阻塞对 `HTML` 文档的解析和渲染。
此时我们的页面上呈现的就是 `script` 标签之前的内容。
如果我们在 `head` 中引入 `script`，那么在 `script` 执行完成前，我们的整个页面都是空白的。
如果我们把 `script` 放到 `body` 底部，在执行 `script` 之前，我们的 `HTML` 已经呈现到用户面前。

通过 `async` 或 `defer` 属性，可以异步加载外链 `script` 文件。
浏览器会新开线程下载文件。不会阻塞 `HTML` 的解析和渲染。
`defer` 是等到 `HTML` 解析完成后，`DOMContentLoaded` 事件前执行。
`async` 是下载完成后立即执行。
`async` 比 `defer` 优先级更高。
